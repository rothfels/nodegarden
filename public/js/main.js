"use strict";!function(){function t(t,i){return null!=t?t:i}function i(t){this.garden=t,this.reset()}function e(t){this.nodes=[],this.container=t,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.started=!1,this.nightmode=!1,window.addEventListener("mousedown",function(t){e.m=15}),window.addEventListener("mouseup",function(t){e.m=0}),1!==s&&(this.canvas.style.transform="scale("+1/s+")",this.canvas.style.transformOrigin="0 0"),this.canvas.id="nodegarden";var e=new i(this);e.m=0,e.update=function(){},e.reset=function(){},e.render=function(){},e.x=Number.MAX_SAFE_INTEGER,e.y=Number.MAX_SAFE_INTEGER,document.addEventListener("mousemove",function(t){e.x=t.pageX*s,e.y=t.pageY*s}),document.documentElement.addEventListener("mouseleave",function(t){e.x=Number.MAX_SAFE_INTEGER,e.y=Number.MAX_SAFE_INTEGER}),this.nodes.unshift(e),this.resize(),this.container.appendChild(this.canvas)}i.prototype.reset=function(){var i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=i.x,s=i.y,n=i.vx,h=i.vy,o=i.m;this.x=t(e,Math.random()*this.garden.width),this.y=t(s,Math.random()*this.garden.height),this.vx=t(n,.5*Math.random()-.25),this.vy=t(h,.5*Math.random()-.25),this.m=t(o,2.5*Math.random()+.5)},i.prototype.addForce=function(t,i){this.vx+=t*i.x/this.m,this.vy+=t*i.y/this.m},i.prototype.distanceTo=function(t){var i=t.x-this.x,e=t.y-this.y,s=Math.sqrt(Math.pow(i,2)+Math.pow(e,2));return{x:i,y:e,total:s}},i.prototype.update=function(){this.x+=this.vx,this.y+=this.vy,(this.x>this.garden.width+50||this.x<-50||this.y>this.garden.height+50||this.y<-50)&&this.reset()},i.prototype.squaredDistanceTo=function(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)},i.prototype.collideTo=function(t){t.vx=t.m*t.vx/(this.m+t.m)+this.m*this.vx/(this.m+t.m),t.vy=t.m*t.vy/(this.m+t.m)+this.m*this.vy/(this.m+t.m),this.reset()},i.prototype.render=function(){this.garden.ctx.beginPath(),this.garden.ctx.arc(this.x,this.y,this.getDiameter(),0,2*Math.PI),this.garden.ctx.fill()},i.prototype.getDiameter=function(){return this.m};var s=window.devicePixelRatio;e.prototype.start=function(){this.playing||(this.playing=!0,this.render(!0))},e.prototype.stop=function(){this.playing&&(this.playing=!1)},e.prototype.resize=function(){this.width=window.innerWidth*s,this.height=window.innerHeight*s,this.area=this.width*this.height,this.nodes.length=Math.sqrt(this.area)/25|0,this.canvas.width=this.width,this.canvas.height=this.height,this.nightMode?this.ctx.fillStyle="#ffffff":this.ctx.fillStyle="#000000";for(var t=0;t<this.nodes.length;t++)this.nodes[t]||(this.nodes[t]=new i(this))},e.prototype.toggleNightMode=function(){this.nightMode=!this.nightMode,this.nightMode?(this.ctx.fillStyle="#ffffff",document.body.classList.add("nightmode")):(this.ctx.fillStyle="#000000",document.body.classList.remove("nightmode"))},e.prototype.render=function(t){var i=this;if(this.playing){t&&requestAnimationFrame(function(){i.render(!0)}),this.ctx.clearRect(0,0,this.width,this.height);for(var e,s,n=0;n<this.nodes.length-1;n++){e=this.nodes[n];for(var h=n+1;h<this.nodes.length;h++){s=this.nodes[h];var o=e.squaredDistanceTo(s),r=3*(e.m*s.m)/o,a=100*r;if(!(.025>a))if(o<=(e.m/2+s.m/2)*(e.m/2+s.m/2))e.m<=s.m?e.collideTo(s):s.collideTo(e);else{var d=e.distanceTo(s),c={x:d.x/d.total,y:d.y/d.total};this.ctx.beginPath(),this.nightMode?this.ctx.strokeStyle="rgba(191,191,191,"+(1>a?a:1)+")":this.ctx.strokeStyle="rgba(63,63,63,"+(1>a?a:1)+")",this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(s.x,s.y),this.ctx.stroke(),e.addForce(r,c),s.addForce(-r,c)}}}for(n=0;n<this.nodes.length;n++)this.nodes[n].render(),this.nodes[n].update()}};var n=window.devicePixelRatio,h=document.getElementById("container"),o=new e(h);o.start();var r=0;h.addEventListener("click",function(t){r++,r>o.nodes.length-1&&(r=1),o.nodes[r].reset({x:t.pageX*n,y:t.pageY*n,vx:0,vy:0})}),window.addEventListener("resize",function(){o.resize()})}();